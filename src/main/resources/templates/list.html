<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body>

<nav class="navbar navbar-dark bg-primary">
    <div class="container-fluid">
        <span class="navbar-brand">
            <i class="bi bi-clipboard-data"></i> Bar Inventory Management
        </span>
        <a href="/" class="btn btn-light">
            <i class="bi bi-house"></i> Home
        </a>
    </div>
</nav>

<div class="container mt-4">

    <!-- ================= BARS LIST ================= -->
    <div th:if="${bars != null}">
        <h4>Bars</h4>
        <a href="/bars/new" class="btn btn-success mb-3">
            <i class="bi bi-plus-circle"></i> New Bar
        </a>

        <table class="table table-striped table-hover">
            <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Location</th>
                <th>Owner</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="bar : ${bars}">
                <td th:text="${bar.barId}"></td>
                <td th:text="${bar.barName}"></td>
                <td th:text="${bar.location}"></td>
                <td th:text="${bar.ownerName}"></td>
                <td>
                    <a th:href="@{/pricing/{id}(id=${bar.barId})}" class="btn btn-sm btn-warning">
                        Pricing
                    </a>
                    <a th:href="@{/sessions/{id}(id=${bar.barId})}" class="btn btn-sm btn-primary">
                        Sessions
                    </a>
                </td>
            </tr>
            <tr th:if="${bars.isEmpty()}">
                <td colspan="5" class="text-center text-muted">
                    No bars found.
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- ================= PRODUCTS LIST ================= -->
    <div th:if="${products != null}">
        <h4>Products</h4>
        <a href="/products/new" class="btn btn-success mb-3">
            <i class="bi bi-plus-circle"></i> New Product
        </a>

        <table class="table table-striped table-hover">
            <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Category</th>
                <th>Brand</th>
                <th>Volume (ML)</th>
                <th>Unit</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="product : ${products}">
                <td th:text="${product.productId}"></td>
                <td th:text="${product.productName}"></td>
                <td th:text="${product.category}"></td>
                <td th:text="${product.brand}"></td>
                <td th:text="${product.volumeML}"></td>
                <td th:text="${product.unit}"></td>
            </tr>
            <tr th:if="${products.isEmpty()}">
                <td colspan="6" class="text-center text-muted">
                    No products found.
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- ================= SESSIONS LIST ================= -->
    <div th:if="${sessions != null}">
        <h4>
            Inventory Sessions -
            <span th:text="${bar.barName}"></span>
        </h4>

        <a th:href="@{/sessions/{barId}/new(barId=${bar.barId})}" class="btn btn-success mb-3">
            <i class="bi bi-plus-circle"></i> New Session
        </a>

        <table class="table table-striped table-hover">
            <thead class="table-dark">
            <tr>
                <th>Session ID</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Shift</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="inv : ${sessions}">
                <td th:text="${inv.sessionId}"></td>
                <td th:text="${#temporals.format(inv.sessionStartTime, 'dd/MM/yyyy HH:mm')}"></td>
                <td th:text="${inv.sessionEndTime != null ? #temporals.format(inv.sessionEndTime, 'dd/MM/yyyy HH:mm') : '-'}"></td>
                <td th:text="${inv.shiftType}"></td>
                <td>
                    <span class="badge bg-warning"
                          th:if="${inv.status.name() == 'IN_PROGRESS'}">In Progress</span>

                    <span class="badge bg-success"
                          th:if="${inv.status.name() == 'COMPLETED'}">Completed</span>

                    <span class="badge bg-danger"
                          th:if="${inv.status.name() == 'ROLLED_BACK'}">Rolled Back</span>
                </td>
                <td>
                    <a th:if="${inv.status.name() == 'IN_PROGRESS'}"
                       th:href="@{/stockroom/{id}(id=${inv.sessionId})}"
                       class="btn btn-sm btn-primary">
                        Continue
                    </a>

                    <span th:if="${inv.status.name() == 'COMPLETED'}"
                          class="text-success">Done</span>

                    <span th:if="${inv.status.name() == 'ROLLED_BACK'}"
                          class="text-danger">Failed</span>
                </td>
            </tr>

            <tr th:if="${sessions.isEmpty()}">
                <td colspan="6" class="text-center text-muted">
                    No sessions found.
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>